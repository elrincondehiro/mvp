let s=[],a=0;const f=4;let m=i=>{let l=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(e){return t.lc=l.push(e),()=>{for(let u=a+f;u<s.length;)s[u]===e?s.splice(u,f):u+=f;let n=l.indexOf(e);~n&&(l.splice(n,1),--t.lc||t.off())}},notify(e,n){let u=!s.length;for(let r of l)s.push(r,t.value,e,n);if(u){for(a=0;a<s.length;a+=f)s[a](s[a+1],s[a+2],s[a+3]);s.length=0}},off(){},set(e){let n=t.value;n!==e&&(t.value=e,t.notify(n))},subscribe(e){let n=t.listen(e);return e(t.value),n},value:i};return t};const o=m({items:[],total:0}),y=i=>{const l=o.get();console.log(l);const t=l.items.findIndex(n=>n.id===i.id);console.log("current Index"+t);let e={items:[],total:0};t>=0?(i.quantity<0&&l.items[t].quantity+i.quantity<0&&(i.quantity=-l.items[t].quantity),e={items:[...l.items],total:l.total+i.price*i.quantity},e.items[t].quantity+=i.quantity,e.items[t].quantity==0&&e.items.splice(t)):i.quantity>0&&(e={items:[...l.items,i],total:l.total+i.price*i.quantity}),o.set(e)};export{y as a,o as c};
